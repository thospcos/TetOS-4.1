<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Machine Love</title>

<style>
    html, body {
        margin:0; padding:0;
        width:100%; height:100%;
        background:black; color:white;
        overflow:hidden;
        font-family:Georgia, serif;
    }

    #screen {
        position:absolute;
        top:0; left:0;
        width:100%; height:100%;
        background:black;
        opacity:1;
        transition:opacity .45s ease;
    }

    #textBox {
        position:absolute;
        top:50%; left:50%;
        width:900px; height:140px;
        margin-left:-450px; margin-top:-70px;
        font-size:42px;
        text-align:center;
        white-space:pre-line;
        opacity:1;
        transition:opacity .45s ease;
    }

    .word {
        display:inline-block;
        margin-right:18px;
        opacity:0;
        transition:opacity .45s ease;
        font-size:110px;
    }

    .bySmall {
        display:inline-block;
        margin-right:12px;
        opacity:0;
        transition:opacity .45s ease;
        font-size:28px;
    }

    .artistWord {
        display:inline-block;
        margin-left:6px;
        opacity:0;
        transition:opacity .45s ease;
        font-size:64px;
    }

    .feat {
        margin-top:18px;
        opacity:0;
        transition:opacity .45s ease;
        font-size:28px;
        display:block;
    }
</style>
</head>

<body>

<audio id="bgm" src="machine_love.mp3.mp3" autoplay loop></audio>

<div id="screen"></div>
<div id="textBox">koi o shite.</div>

<script>
const screen = document.getElementById("screen");
const textBox = document.getElementById("textBox");

function setText(t){ textBox.innerText = t; }
function setHTML(h){ textBox.innerHTML = h; }

function fadeOutAll(callback){
    screen.style.opacity = 0;
    textBox.style.opacity = 0;
    setTimeout(()=>{ if (callback) callback(); }, 600);
}

function fadeInAll(callback){
    screen.style.opacity = 1;
    textBox.style.opacity = 1;
    setTimeout(()=>{ if (callback) callback(); }, 600);
}

function showFinalWhite() {
    // Instant pop
    screen.style.transition = "none";
    textBox.style.transition = "none";

    screen.style.background = "white";
    screen.style.opacity = 1;

    textBox.style.color = "black";
    textBox.style.opacity = 1;
    textBox.innerHTML = "";

    // Build DOM
    const line1 = document.createElement("div");
    const span1 = document.createElement("span");
    span1.className = "word";
    span1.textContent = "Machine";

    const span2 = document.createElement("span");
    span2.className = "word";
    span2.textContent = "Love";

    line1.appendChild(span1);
    line1.appendChild(span2);

    const line2 = document.createElement("div");
    const by = document.createElement("span");
    by.className = "bySmall";
    by.textContent = "by";

    const jamie = document.createElement("span");
    jamie.className = "artistWord";
    jamie.textContent = "Jamie";

    const paige = document.createElement("span");
    paige.className = "artistWord";
    paige.textContent = "Paige";

    line2.appendChild(by);
    line2.appendChild(jamie);
    line2.appendChild(paige);

    const feat = document.createElement("div");
    feat.className = "feat";
    feat.textContent = "featuring Kasane Teto SV";

    textBox.appendChild(line1);
    textBox.appendChild(line2);
    textBox.appendChild(feat);

    // Reset opacity
    span1.style.opacity = 0;
    span2.style.opacity = 0;
    by.style.opacity = 0;
    jamie.style.opacity = 0;
    paige.style.opacity = 0;
    feat.style.opacity = 0;

    // Reveal sequence
    setTimeout(()=>{ span1.style.opacity = 1; }, 100);
    setTimeout(()=>{ span2.style.opacity = 1; }, 700);
    setTimeout(()=>{ by.style.opacity = 1; }, 1300);
    setTimeout(()=>{ jamie.style.opacity = 1; }, 1900);
    setTimeout(()=>{ paige.style.opacity = 1; }, 2500);
    setTimeout(()=>{ feat.style.opacity = 1; }, 3100);
}

/* TIMELINE */

setTimeout(()=>{
    fadeOutAll(()=>{
        setText("This song is a tribute to\n耳のあるロボットの唄\n(Song of the Eared Robot)\nby nwp8861.");
        fadeInAll();
    });
}, 21000);

setTimeout(()=>{
    fadeOutAll(()=>{
        setText("It is about the truths that lay\nin hiding within artifice,\nand a computer falling in love.");
        fadeInAll();
    });
}, 27000);

setTimeout(()=>{
    fadeOutAll(()=>{
        showFinalWhite();
    });
}, 31000);
</script>


</body>
</html>
